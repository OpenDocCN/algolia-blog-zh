<html>
<head>
<title>How to inspect Algolia requests in DevTools: Algolia Analyzer extension | Algolia Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在DevTools中检查Algolia请求:Algolia分析器扩展</h1>
<blockquote>原文：<a href="https://www.algolia.com/blog/engineering/algolia-analyzer-browser-extension-inspect-algolia-specific-requests-in-devtools/#0001-01-01">https://www.algolia.com/blog/engineering/algolia-analyzer-browser-extension-inspect-algolia-specific-requests-in-devtools/#0001-01-01</a></blockquote><div><div class="css-t54cg4"><p class="translated">你在浏览器的开发工具上花了多少时间？拜托，说实话。太多了，不是吗？别担心，我也是——我叫艾曼纽，是阿尔戈利亚公司的工程师。有时候我会花几个小时调试请求和API调用，所以我已经和DevTools中的Network选项卡成了非常非常好的朋友。但是像任何混乱的关系一样，我们有沟通问题:通常我会向它询问一些API调用的信息，但是DevTools给我的信息不清楚或者不如我期望的那样有用。</p>
<p class="translated">然后我有了一个想法。我是开发商，对吧？与其依赖通用工具来适应我非常具体的以Algolia为中心的用例，为什么我不能构建一个Chrome扩展来帮助我调试Algolia请求呢？</p>
<p class="translated">我照做了。在高层次上，该扩展在Chrome DevTools中添加了一个名为“<a href="https://github.com/algolia/algolia-analyzer"> Algolia分析器</a>”的新面板。起初这相当困难——我有扩展的经验，但没有将它们添加到DevTools的经验。我找到了<a href="https://developer.chrome.com/docs/extensions/mv3/devtools/">正确的文档</a>，但是它们没有为版本3清单更新。幸运的是，它基本上是兼容的，但这种一开始就出现的小问题并没有让我充满希望。经过一番欺骗，我终于得到了这个新的定制面板:</p>
<p class="translated"><img loading="lazy" class="alignleft size-full wp-image-15788" src="../Images/14975211c8415663875dbd76e78ff416.png" alt="Algolia Analyzer browser extension DevTools tab screenshot" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-1.png 990w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-1-320x67.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-1-720x151.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-1-768x161.png 768w" sizes="(max-width: 990px) 100vw, 990px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-1.png"/></p>
<p class="translated">我想做的第一件事是创建一个小工具来检查API键的访问控制列表。这非常有帮助，因为我们永远不应该在前端Algolia应用程序中使用admin API键(<em>或任何应用程序，如果我们能帮助它的话</em>)。你只能得到一把万能钥匙，可以解锁Algolia的任何功能，包括删除所有内容和为你注册更昂贵的计划——如果放在错误的环境中，这些功能肯定会被滥用。admin键允许我们创建只具有特定权限的角色和API键，并且我们只在应用程序内部使用<em>和</em>。因此，我在这里添加了这个功能，以避免每次我们想要检查给定API键的权限时都必须进入我们的Algolia仪表板。</p>
<p class="translated">为了测试这一点，我去了我的同事Jaden为最近一个以Algolia为主题的项目制作的网站。它看起来是这样的，显然包含了API键:</p>
<p class="translated"><img loading="lazy" class="alignleft wp-image-15791 size-full" src="../Images/427b757a7de2a9d924f5a3d7ad7ad99d.png" alt="Algolia Analyzer browser extension screenshot admin API keys hidden" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-2.png 1184w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-2-320x66.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-2-720x148.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-2-768x158.png 768w" sizes="(max-width: 1184px) 100vw, 1184px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-2.png"/></p>
<p class="translated">当然，这里有一些危险的能力，这就是为什么我们不想在前端使用它(或者任何地方，如果可能的话)。想象一下，一些捣乱者看到你用了你的管理键，然后用了你的整个Algolia搜索索引。使用默认的搜索API键，它应该看起来更像这样:</p>
<p class="translated"><img loading="lazy" class="alignleft wp-image-15793 size-full" src="../Images/6a32df52fa4a2e713067cdac06fd3d79.png" alt="Algolia Analyzer browser extension screenshot secure API key shown" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-3.png 1196w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-3-320x65.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-3-720x147.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-3-768x157.png 768w" sizes="(max-width: 1196px) 100vw, 1196px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-3.png"/></p>
<p class="translated">好多了。</p>
<p class="translated">另一个有用的特性:向服务器发出的请求列表:</p>
<p class="translated"><img loading="lazy" class="alignleft size-full wp-image-15795" src="../Images/54f8a9c88bcfdacb09be820d843539bd.png" alt="Algolia Analyzer browser extension screenshot first POST request view" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4.png 2000w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4-320x53.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4-720x119.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4-768x127.png 768w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4-1536x254.png 1536w" sizes="(max-width: 2000px) 100vw, 2000px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-4.png"/></p>
<p class="translated">这是自动更新的，所以它向我们展示了我们的程序是如何与Algolia交互的。这个特定的应用程序只有一个初始搜索请求(只是为了显示结果的初始页面)，但当你真正开始搜索时，它会上升:</p>
<p class="translated"><img loading="lazy" class="alignleft size-full wp-image-15797" src="../Images/e5f83b3e8693e0de32b90db9a0c73def.png" alt="Algolia Analyzer browser extension screenshot subsequent POST request from search query view" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-5.png 1526w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-5-320x170.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-5-720x383.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-5-768x409.png 768w" sizes="(max-width: 1526px) 100vw, 1526px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-5.png"/></p>
<p class="translated">在搜索框中键入四个字符后，您已经进行了五次搜索(在这种情况下，我键入了<code>luke</code>，因此Algolia被ping为空白请求、<code>l</code>、<code>lu</code>、<code>luk</code>和<code>luke</code>)。结果上方的那些框让我只过滤某些类型的结果，如果您返回奇怪的错误或者如果您正在使用多个Algolia应用程序id，这将非常有用。</p>
<p class="translated">如果你点击其中任何一个请求，你会看到一个解释这个请求的窗口:</p>
<p class="translated"><img loading="lazy" class="alignleft wp-image-15799 size-full" src="../Images/01a2ae18cdadca41b079d6ae69f26f5f.png" alt="Algolia Analyzer browser extension screenshot request detailed view" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-6.png 1288w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-6-222x178.png 222w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-6-499x400.png 499w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-6-768x615.png 768w" sizes="(max-width: 1288px) 100vw, 1288px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-6.png"/></p>
<p class="translated">在最初的描述中，已经有很多我发现自己在调试过程中经常需要的信息。例如，常见的故障诊断问题是“您使用的是最新版本的__？”，这里我们可以在<code>x-algolia-agent</code>参数中说出所有相关库的确切版本。以前肯定可以在DevTools中找到这些信息，但是在Network选项卡中这部分看起来是这样的:</p>
<p class="translated"><img loading="lazy" class="alignleft size-full wp-image-15801" src="../Images/0c46abe94301431b90ed9874518cce6e.png" alt="Algolia Analyzer browser extension screenshot requests response standard DevTools Network tab view" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7.png 2000w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7-320x48.png 320w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7-720x108.png 720w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7-768x115.png 768w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7-1536x230.png 1536w" sizes="(max-width: 2000px) 100vw, 2000px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-7.png"/></p>
<p class="translated">很大的进步，对吧？</p>
<p class="translated">下面是我们从Algolia得到的一个简洁的回复:</p>
<p class="translated"><img loading="lazy" class="alignleft size-full wp-image-15803" src="../Images/a14573f411923f9dff18f2d2f3c2e4a5.png" alt="Algolia Analyzer browser extension screenshot response detailed view" srcset="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-8.png 1150w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-8-210x178.png 210w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-8-471x400.png 471w, https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-8-768x652.png 768w" sizes="(max-width: 1150px) 100vw, 1150px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/08/algolia-analyzer-devtools-requests-browser-extension-8.png"/></p>
<p class="translated">当然，我们可以在代码中和更通用的DevTools视图中访问所有这些数据，但是现在我们不需要担心到处粘贴<code>console.log</code>或者深入到一个视图中，该视图主要是为了帮助您确定您正在加载哪个CSS文件而设计的。多亏了我的<a href="https://github.com/algolia/algolia-analyzer"> Algolia分析器浏览器扩展</a>，所有Algolia特有的信息现在都在那里，都在一个地方。</p>
<p class="translated">不过，我不能假装这是刚刚发生的。实际上很难规划出哪些信息应该放在哪里。我不得不有意识地删掉一些不需要的部分，这样它们就不会挤掉重要的部分。我们对这里的信息是如何构建的进行了大量思考。我能够在这个项目中使用React，因此它使组织过程更加精简。</p>
<p class="translated">如果你有兴趣使用这个扩展，我很乐意听到你的反馈！让我知道你是否可以在新的DevTools标签中使用其他的东西，通过发推特@Algolia 和添加PR到GitHub repo 的<a href="https://github.com/algolia/algolia-analyzer">！我很高兴听到你的想法！</a></p>
</div></div>    
</body>
</html>