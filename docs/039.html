<html>
<head>
<title>Indexing Markdown content with Algolia - Algolia Blog | Algolia Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Algolia索引减价内容- Algolia博客</h1>
<blockquote>原文：<a href="https://www.algolia.com/blog/engineering/indexing-markdown-content-with-algolia/#0001-01-01">https://www.algolia.com/blog/engineering/indexing-markdown-content-with-algolia/#0001-01-01</a></blockquote><div><div class="css-t54cg4"><p class="translated">我与Starschema全栈工程师Soma Osvay合作，写了一个我非常喜欢的项目:开发人员文档。Soma和我都希望您喜欢这篇文章，其中我们讨论了用例、挑战以及Soma提出的实现。</p>
<hr/>
<p class="translated">在Starschema，我们已经完成了许多项目，作为markdown documentation咨询的一部分。当我们支持这些现有的解决方案或者想要开发一个新的项目时，我们经常想要搜索所有的文档。我们目前没有解决方案，因为我们必须手动完成这项工作，这耗费了我们很多工时。</p>
<h2 class="translated"><a id="use-case" class="anchor" href="#use-case" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>用例</h2>
<p class="translated">我们需要能够搜索与特定主题相关的项目，以检查实现细节，从代码中获得灵感，等等。销售团队还需要一个解决方案来确定我们的团队为某些主题完成了什么样的项目，并能够快速将其传达给潜在客户。对于我们的开发人员来说，拥有类似内部堆栈溢出的东西也很棒，因为我们在Tableau中做了很多深入的技术工作。项目经理还需要能够确定哪些员工使用过某些技术，这样他们就可以快速、轻松地得到问题的答案。</p>
<p class="translated">简而言之，我们需要能够基于以下属性搜索我们自己的项目:</p>
<ol>
<li class="translated">使用的技术(编码语言、数据库等)</li>
<li class="translated">项目关键字(标签)</li>
<li class="translated">项目文件本身，如安装说明、技术文件等。</li>
<li class="translated">项目发生的时间框架</li>
</ol>
<p class="translated">所有这些属性都存在于内部文档降价文件中——我们只需要一种方法来搜索它们。</p>
<h2 class="translated"><a id="implementation-plan" class="anchor" href="#implementation-plan" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>实施计划</h2>
<p class="translated">计划使用NodeJS CLI作为概念验证，它将:</p>
<ol>
<li class="translated">搜索顶级的GitHub公共库并获取README markdown文件(这将最终代表我们的内部项目)</li>
<li class="translated">将文档文件与项目的基本信息(标题、编程语言、标签等)一起存储到Algolia中</li>
</ol>
<p class="translated">CLI将包含高级日志记录和命令行参数，以便于使用。我们还想把它放在网上，这样人们就可以试用了。</p>
<h2 class="translated"><a id="challenge" class="anchor" href="#challenge" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>挑战</h2>
<p class="translated">眼下最大的挑战是记录的大小——Algolia最多只允许我们的记录达到100KB。然而，大多数降价文档文件要大得多。解决方案是我们需要在索引中将markdown文件分成多个部分。然后，我们还需要确保当我们搜索某个东西时，单个项目只出现一次——即使它被分成多个记录。</p>
<p class="translated">幸运的是，Algolia有一个独特的功能，所以我们可以很容易地重复这些结果。</p>
<h2 class="translated"><a id="indexer-implementation" class="anchor" href="#indexer-implementation" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>索引器实现</h2>
<p class="translated">为了尽可能简单地使用索引器，我选择为它创建一个CLI，如上所述。提供所需的参数后，该工具将自动初始化存储库，删除任何现有记录，并配置相关性设置。</p>
<p class="translated">为该工具提供动力的是一个简单的GitHub API，它获取所需数量的顶级存储库，提取它们的所有元数据，并下载README文件。它还会过滤掉缺少所有者或缺少自述文件的存储库，为我们提供最佳结果。最后，它还会将markdown内容转换为HTML，以便在前端更容易地呈现。</p>
<p class="translated">为了控制记录大小，该工具会自动将超过50k个字符的READMEs分割成更多的记录。这样，记录不会变得太大，但是一个记录仍然应该服务于几乎所有的存储库。然后，它会将这些信息一次同步到Algolia 100条记录，这样我们就可以满足他们的批处理建议，如文档中的<a href="https://www.algolia.com/doc/guides/sending-and-managing-data/send-and-update-your-data/how-to/sending-records-in-batches/">这里的</a>所述。</p>
<h2 class="translated"><a id="frontend-implementation" class="anchor" href="#frontend-implementation" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>前端实现</h2>
<p class="translated">作为起点，我利用了Algolia发布的<a href="https://github.com/algolia/instantsearch/tree/master/packages/create-instantsearch-app"> create-instantsearch-app </a>库，并启动了一个InstantSearch.js样板文件。从这里，我可以添加InstantSearch.js提供的其他小部件，比如分页和页面大小选择器，它们工作得非常好。</p>
<p class="translated">因为我们还通过降价收集了存储库元数据，所以我们还需要定制hits组件来包含这些附加信息。通常元数据和库描述一样重要，所以开发人员一眼就能看出它是否是一个流行的库，谁发布了它，标签等等。我还添加了facets，这样用户就可以通过编程语言、标签或者分叉次数进行过滤。</p>
<p class="translated">拼图的最后一块是添加“打开文档”按钮，允许您在不离开应用程序的情况下，在弹出窗口中快速轻松地阅读存储库的降价内容。如果我们点击的记录有多行，它会自动加载额外的记录并将它们连接在一起显示——太棒了！</p>
<h2 class="translated"><a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>结论</h2>
<p class="translated">这个项目是一个有趣的测试，并真正向我展示了Algolia对于像我们这样的不同用例是多么灵活。这些现成的小部件在原型制作过程中节省了我大量的时间，并且从最初的几次击键中获得相关的结果给我留下了非常深刻的印象。我还认为，如果我们能够利用Algolia推荐的力量，如果我们能够从用户内部点击项目中产生足够多的事件，那将会非常有趣。</p>
<p class="translated">你可以点击这里观看GitHub测试项目<a href="https://stackblitz.com/github/algolia-samples/algolia-js-document-indexer/tree/main/frontend?file=src%2Falgolia.js">的现场演示，点击一个按钮，你就可以使用默认的演示凭证来查看我们的索引。对后端索引代码感兴趣？你可以在GitHub上找到这里的</a><a href="https://github.com/algolia-samples/algolia-js-document-indexer/tree/main/indexer">！</a></p>
<p class="translated"><a class="aligncenter" title="Algolia Code Exchange" href="https://www.algolia.com/developers/code-exchange/showcase/indexing-markdown-files-and-metadata-using-node-js"> <img loading="lazy" class="wp-image-13777" src="../Images/7665551c18b687f25dcadc15cb213b7d.png" alt="Algolia Code Exchange" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2022/01/CodeX@2x.png"/> </a></p>
<hr/>
<p class="translated"><em>我们希望您喜欢来自Soma的这篇深入的文章！如果你正在寻找更多这样的内容，我们在<a href="https://www.algolia.com/blog/engineering/"> Algolia工程博客</a>上有更多的主题！如果你是Algolia的新手，你可以通过注册一个<a href="https://www.algolia.com/users/sign_up?utm_source=blog&amp;utm_medium=main-blog&amp;utm_campaign=devrel&amp;utm_id=blog-algolia-and-rust">免费等级账户</a>来尝试一下。</em></p>
</div></div>    
</body>
</html>